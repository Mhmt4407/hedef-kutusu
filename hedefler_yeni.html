<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <title>Mine mål</title>
  <style>
    html {
      scroll-behavior: smooth;
    }

    :root {
      --bg-color: #ffffff;
      --text-color: #202020;
      --item-bg: #f0f0f0;
      --checkbox-border: #888;
      --checkbox-check: green;
      --delete-color: red;
      --button-bg: #008000;
      --button-text: white;
      --hover-accent: #006600;
      --focus-outline: #33aa33;
      --date-color: #666;
      --date-icon-color: #888;
    }

    body.dark {
      --bg-color: #121212;
      --text-color: #e0e0e0;
      --item-bg: #1f1f1f;
      --checkbox-border: #aaa;
      --checkbox-check: #00ff00;
      --delete-color: #ff5555;
      --button-bg: #005500;
      --button-text: #ddffdd;
      --hover-accent: #009900;
      --focus-outline: #55ff55;
      --date-color: #aaa;
      --date-icon-color: #bbb;
    }

    body {
      font-family: Arial, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      padding: 30px;
      transition: background 0.3s, color 0.3s;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    h2 {
      font-size: 44px;
      font-weight: 900;
      margin: 0;
    }

    .toggle-theme {
      background: none;
      border: 2px solid var(--text-color);
      color: var(--text-color);
      font-size: 18px;
      font-weight: 700;
      padding: 8px 16px;
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.3s, color 0.3s, box-shadow 0.3s;
      box-shadow: none;
    }
    .toggle-theme:hover,
    .toggle-theme:focus {
      background: var(--hover-accent);
      color: var(--button-text);
      outline: none;
      box-shadow: 0 0 8px var(--hover-accent);
    }

    .input-area {
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      width: 100%;
      gap: 12px;
    }

    input[type="text"], input[type="date"] {
      padding: 18px;
      font-size: 24px;
      font-weight: 700;
      border: 2px solid var(--button-bg);
      border-radius: 12px;
      transition: border-color 0.3s, box-shadow 0.3s;
      box-shadow: 0 0 0 1px var(--button-bg);
      flex-grow: 1;
    }
    input[type="text"]:focus, input[type="date"]:focus {
      outline: none;
      border-color: var(--hover-accent);
      box-shadow: 0 0 8px var(--hover-accent);
    }
    input[type="date"] {
      max-width: 180px;
      color: var(--text-color);
      background-color: var(--item-bg);
    }
    body.dark input[type="date"] {
      background-color: var(--item-bg);
      color: var(--text-color);
    }

    button {
      padding: 14px 28px;
      font-size: 24px;
      font-weight: 700;
      background-color: var(--button-bg);
      color: var(--button-text);
      border: none;
      border-radius: 12px;
      margin-left: 0;
      cursor: pointer;
      transition: background-color 0.3s, box-shadow 0.3s;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 8px rgba(0, 128, 0, 0.4);
      user-select: none;
    }
    button:hover, button:focus {
      background-color: var(--hover-accent);
      box-shadow: 0 6px 12px rgba(0, 153, 0, 0.6);
      outline: none;
    }
    button:active {
      transform: scale(0.97);
      transition: transform 0.1s;
    }

    ul {
      list-style-type: none;
      padding-left: 0;
      margin-bottom: 30px;
    }

    li {
      margin: 18px 0;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--item-bg);
      border-radius: 12px;
      padding: 14px 20px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.1);
      transition: background 0.3s, box-shadow 0.3s;
      user-select: none;
    }
    li:hover {
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
    }

    .item-left {
      display: flex;
      align-items: center;
      flex-grow: 1;
      gap: 16px;
      cursor: pointer;
      user-select: none;
    }

    .checkbox {
      width: 28px;
      height: 28px;
      border: 2.5px solid var(--checkbox-border);
      border-radius: 8px;
      position: relative;
      transition: border-color 0.3s, background-color 0.3s;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .checkbox::after {
      content: "";
      opacity: 0;
      transition: opacity 0.3s ease;
      font-size: 22px;
      font-weight: 900;
      color: white;
      user-select: none;
    }
    .done .checkbox {
      border-color: var(--checkbox-check);
      background-color: var(--checkbox-check);
    }
    .done .checkbox::after {
      content: "✔";
      opacity: 1;
      animation: checkFade 0.4s ease forwards;
    }
    @keyframes checkFade {
      from {opacity: 0; transform: scale(0.7) rotate(-45deg);}
      to {opacity: 1; transform: scale(1) rotate(0deg);}
    }

    .done .item-text {
      color: var(--checkbox-check);
      text-decoration: line-through;
      transition: color 0.3s;
    }

    .item-text {
      flex-grow: 1;
      font-weight: 700;
      color: var(--text-color);
      transition: color 0.3s;
    }

    .date {
      font-size: 18px;
      color: var(--date-color);
      font-weight: 700;
      white-space: nowrap;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 6px;
      flex-shrink: 0;
    }
    .date-icon {
      font-size: 18px;
      color: var(--date-icon-color);
      user-select: none;
      display: inline-block;
    }

    .delete {
      color: var(--delete-color);
      font-size: 28px;
      cursor: pointer;
      margin-left: 24px;
      user-select: none;
      transition: color 0.3s;
      flex-shrink: 0;
    }
    .delete:hover,
    .delete:focus {
      color: #ff0000cc;
      outline: none;
      text-shadow: 0 0 4px var(--delete-color);
    }

    .stats {
      font-size: 22px;
      font-weight: 800;
      user-select: none;
      border-top: 2px solid var(--text-color);
      padding-top: 15px;
      max-width: 400px;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <h2>Mine mål</h2>
    <button class="toggle-theme" onclick="toggleTheme()" aria-label="Skift tema">Skift tema</button>
  </div>

  <div class="input-area">
    <input type="text" id="newItem" placeholder="Skriv et nyt mål..." aria-label="Skriv et nyt mål" />
    <input type="date" id="deadline" aria-label="Vælg deadline" placeholder="Vælg dato" />
    <button onclick="addItem()" aria-label="Tilføj nyt mål">➕ Tilføj</button>
  </div>

  <ul id="list"></ul>

  <div class="stats" id="stats" aria-live="polite"></div>

  <script>
    function formatDate(d) {
      if (!d) return "";
      const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
      let dateStr = new Date(d).toLocaleDateString('da-DK', options);
      return dateStr.charAt(0).toUpperCase() + dateStr.slice(1);
    }

    function saveList() {
      const items = [];
      document.querySelectorAll("#list li").forEach(li => {
        items.push({
          text: li.querySelector(".item-text").textContent,
          date: li.querySelector(".date").dataset.rawDate || "",
          done: li.classList.contains("done")
        });
      });
      localStorage.setItem("goalList", JSON.stringify(items));
    }

    function loadList() {
      const saved = localStorage.getItem("goalList");
      if (saved) {
        const items = JSON.parse(saved);
        items.sort((a,b) => {
          if (a.date && b.date) return new Date(a.date) - new Date(b.date);
          if (a.date) return -1;
          if (b.date) return 1;
          return 0;
        });
        items.forEach(item => addListItem(item.text, item.date, item.done));
      }
      updateStats();
    }

    function addListItem(text, date = "", done = false) {
      const ul = document.getElementById("list");
      const li = document.createElement("li");
      if (done) li.classList.add("done");

      li.innerHTML = `
        <div class="item-left" tabindex="0" role="checkbox" aria-checked="${done}">
          <div class="checkbox"></div>
          <span class="item-text">${text}</span>
        </div>
        <div class="date" data-raw-date="${date}">
          <span class="date-icon" aria-hidden="true">⏳</span>
          ${date ? formatDate(date) : ""}
        </div>
        <div class="delete" role="button" tabindex="0" aria-label="Slet mål">✖️</div>
      `;

      ul.appendChild(li);

      const itemLeft = li.querySelector(".item-left");
      const deleteBtn = li.querySelector(".delete");

      itemLeft.addEventListener("click", () => {
        li.classList.toggle("done");
        itemLeft.setAttribute("aria-checked", li.classList.contains("done"));
        saveList();
        updateStats();
      });
      itemLeft.addEventListener("keydown", e => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          itemLeft.click();
        }
      });

      deleteBtn.addEventListener("click", () => {
        li.remove();
        saveList();
        updateStats();
      });
      deleteBtn.addEventListener("keydown", e => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          deleteBtn.click();
        }
      });

      saveList();
      updateStats();
    }

    function addItem() {
      const input = document.getElementById("newItem");
      const deadlineInput = document.getElementById("deadline");
      const text = input.value.trim();
      const date = deadlineInput.value;

      if (text === "") {
        alert("Skriv venligst et mål.");
        input.focus();
        return;
      }
      addListItem(text, date, false);
      input.value = "";
      deadlineInput.value = "";
      input.focus();
    }

    function updateStats() {
      const ul = document.getElementById("list");
      const total = ul.children.length;
      const done = ul.querySelectorAll("li.done").length;
      const stats = document.getElementById("stats");
      stats.textContent = `Mål i alt: ${total} - Fuldførte: ${done}`;
    }

    function toggleTheme() {
      document.body.classList.toggle("dark");
      // Gem tema i localStorage
      if(document.body.classList.contains("dark")) {
        localStorage.setItem("theme", "dark");
      } else {
        localStorage.removeItem("theme");
      }
    }

    // Load tema ved start
    if(localStorage.getItem("theme") === "dark") {
      document.body.classList.add("dark");
    }

    loadList();
  </script>
</body>
</html>
